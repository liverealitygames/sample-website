{% extends "homepage/base.html" %}
{% block content %} 
{% load static %}
{% load community_filters %}
<div class="container mt-4">
  <div id="community-list" class="row row-cols-1 row-cols-md-2 row-cols-lg-3 g-4">
      {% for community in communities %}
      <div class="col-md-4 community-item">
        <div class="card h-100">
            <h3 class="card-header text-center">
                <a href="{% url "community:community_info" community.id %}" class="text-light">{{ community }}</a>
            </h3>
            <a href="{% url "community:community_info" community.id %}">
                <img src="{% static community.season_set.first.format|get_default_banner %}" class="d-block user-select-none" width="100%" height="200" alt="Random image">
            </a>
            <div class="card-body d-flex justify-content-between">
                <a href="{{post.season.application_link}}" class="card-link text-secondary">{{ community.status }}</a>
            </div>
                <div class="card-footer text-muted d-flex justify-content-between">
                    <span>{{ community.season_set.count }} seasons</span>
                    <span>{{ community.season_set.first.location }}</span>
                </div>
            </div>
        </div>
      {% endfor %}
  </div>
  
  <div class="pagination-container mt-4 mb-4 d-flex justify-content-center align-items-center">
    <button id="prev-page" class="btn btn-primary" disabled>← Prev</button>
    <span id="page-info" class="mx-3"></span>
    <button id="next-page" class="btn btn-primary">Next →</button>
  </div>
</div>

<script>
  document.addEventListener("DOMContentLoaded", function () {
      const itemsPerPage = 6;
      const communityItems = document.querySelectorAll(".community-item");
      const totalPages = Math.ceil(communityItems.length / itemsPerPage);
      let currentPage = 1;
      
      function showPage(page) {
          communityItems.forEach((item, index) => {
              item.style.display = (index >= (page - 1) * itemsPerPage && index < page * itemsPerPage) ? "block" : "none";
          });
          document.getElementById("page-info").textContent = `Page ${page} of ${totalPages}`;
          document.getElementById("prev-page").disabled = (page === 1);
          document.getElementById("next-page").disabled = (page === totalPages);
      }

      document.getElementById("prev-page").addEventListener("click", function () {
          if (currentPage > 1) {
              currentPage--;
              showPage(currentPage);
          }
      });

      document.getElementById("next-page").addEventListener("click", function () {
          if (currentPage < totalPages) {
              currentPage++;
              showPage(currentPage);
          }
      });
      
      showPage(currentPage);
  });
</script>
{% endblock %}
